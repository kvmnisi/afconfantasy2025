<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy AFCON League</title>
    <link rel="stylesheet" href="style.css">
    <link rel = "stylesheet" href = "app.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <nav class = "navbar">
            <div class = "nav-brand">
                <i class = "fas fa-futbol"></i>
                <h1> AFCON 2025 FANTASY LEAGUE</h1>
            </div>

            <div class ="nav-user">
                <span id = "user-email">Loading...</span>
                <div class = "user-dropdown">
                    <button class="user-menu-btn">
                        <i class = "fas fa-user-circle"></i>
                        <i class = "fas fa-chevron-down"></i>
                    </button>
                  <div class="dropdown-menu">
                    <a href = "#" onclick="signOut()" class="dropdown-item">
                        <i class = "fas fa-sign-out-alt"></i> Sign Out
                    </a>
                  </div>
                </div>
            </div>
        </nav>
        <main class="main-content">

        <div class="mode-selector">
            <button class="mode-btn active" onclick="switchMode('budget')">
                <i class="fas fa-coins"></i> Budget Mode (100m)
            </button>
            <button class="mode-btn" onclick="switchMode('draft')">
                <i class="fas fa-users"></i> Draft Mode
            </button>
        </div>

        <div id="budget-mode" class="game-mode">
            <div class="budget-header">
                <h2>Budget: <span id="budget">100</span>m</h2>
                <div class="team-summary">
                    <div>GK: <span id="gk-count">0</span>/2</div>
                    <div>DEF: <span id="def-count">0</span>/5</div>
                    <div>MID: <span id="mid-count">0</span>/5</div>
                    <div>FWD: <span id="fwd-count">0</span>/3</div>
                </div>
            </div>

            <div class="players-container">
                <div class="filters">
                    <input type="text" id="search" placeholder="Search players..." onkeyup="filterPlayers()">
                    <select id="position-filter" onchange="filterPlayers()">
                        <option value="all">All Positions</option>
                        <option value="GK">Goalkeeper</option>
                        <option value="DEF">Defender</option>
                        <option value="MID">Midfielder</option>
                        <option value="FWD">Forward</option>
                    </select>
                </div>

                <div class="players-grid" id="players-grid">
                    <!-- Players will be loaded here -->
                </div>
            </div>

            <!-- Replace the existing my-team section with this: -->

            <div class="my-team">
                <h3>My Team (<span id="team-count">0</span>/15)</h3>
                
                <div class="team-formation">
                    <div class="starting-xi">
                        <h4>Starting XI <span id="xi-count">0</span>/11</h4>
                        <div class="formation-layout">
                            <!-- Goalkeeper -->
                            <div class="position-slot gk-slot" data-position="GK" data-slot="xi" onclick="selectPosition('GK', 'xi')">
                                <div class="slot-label">GK</div>
                                <div class="player-assigned" id="xi-gk">Empty</div>
                            </div>
                            
                            <!-- Defenders (4) -->
                            <div class="defenders-row">
                                <div class="position-slot def-slot" data-position="DEF" data-slot="xi" onclick="selectPosition('DEF', 'xi')">
                                    <div class="slot-label">DEF</div>
                                    <div class="player-assigned" id="xi-def-1">Empty</div>
                                </div>
                                <div class="position-slot def-slot" data-position="DEF" data-slot="xi" onclick="selectPosition('DEF', 'xi')">
                                    <div class="slot-label">DEF</div>
                                    <div class="player-assigned" id="xi-def-2">Empty</div>
                                </div>
                                <div class="position-slot def-slot" data-position="DEF" data-slot="xi" onclick="selectPosition('DEF', 'xi')">
                                    <div class="slot-label">DEF</div>
                                    <div class="player-assigned" id="xi-def-3">Empty</div>
                                </div>
                                <div class="position-slot def-slot" data-position="DEF" data-slot="xi" onclick="selectPosition('DEF', 'xi')">
                                    <div class="slot-label">DEF</div>
                                    <div class="player-assigned" id="xi-def-4">Empty</div>
                                </div>
                            </div>
                            
                            <!-- Midfielders (4) -->
                            <div class="midfielders-row">
                                <div class="position-slot mid-slot" data-position="MID" data-slot="xi" onclick="selectPosition('MID', 'xi')">
                                    <div class="slot-label">MID</div>
                                    <div class="player-assigned" id="xi-mid-1">Empty</div>
                                </div>
                                <div class="position-slot mid-slot" data-position="MID" data-slot="xi" onclick="selectPosition('MID', 'xi')">
                                    <div class="slot-label">MID</div>
                                    <div class="player-assigned" id="xi-mid-2">Empty</div>
                                </div>
                                <div class="position-slot mid-slot" data-position="MID" data-slot="xi" onclick="selectPosition('MID', 'xi')">
                                    <div class="slot-label">MID</div>
                                    <div class="player-assigned" id="xi-mid-3">Empty</div>
                                </div>
                                <div class="position-slot mid-slot" data-position="MID" data-slot="xi" onclick="selectPosition('MID', 'xi')">
                                    <div class="slot-label">MID</div>
                                    <div class="player-assigned" id="xi-mid-4">Empty</div>
                                </div>
                            </div>
                            
                            <!-- Forwards (2) -->
                            <div class="forwards-row">
                                <div class="position-slot fwd-slot" data-position="FWD" data-slot="xi" onclick="selectPosition('FWD', 'xi')">
                                    <div class="slot-label">FWD</div>
                                    <div class="player-assigned" id="xi-fwd-1">Empty</div>
                                </div>
                                <div class="position-slot fwd-slot" data-position="FWD" data-slot="xi" onclick="selectPosition('FWD', 'xi')">
                                    <div class="slot-label">FWD</div>
                                    <div class="player-assigned" id="xi-fwd-2">Empty</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bench-section">
                        <h4>Bench <span id="bench-count">0</span>/4</h4>
                        <div class="bench-layout">
                            <div class="bench-slot" data-position="any" data-slot="bench" onclick="selectPosition('any', 'bench')">
                                <div class="slot-label">BENCH</div>
                                <div class="player-assigned" id="bench-1">Empty</div>
                            </div>
                            <div class="bench-slot" data-position="any" data-slot="bench" onclick="selectPosition('any', 'bench')">
                                <div class="slot-label">BENCH</div>
                                <div class="player-assigned" id="bench-2">Empty</div>
                            </div>
                            <div class="bench-slot" data-position="any" data-slot="bench" onclick="selectPosition('any', 'bench')">
                                <div class="slot-label">BENCH</div>
                                <div class="player-assigned" id="bench-3">Empty</div>
                            </div>
                            <div class="bench-slot" data-position="any" data-slot="bench" onclick="selectPosition('any', 'bench')">
                                <div class="slot-label">BENCH</div>
                                <div class="player-assigned" id="bench-4">Empty</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="team-summary-card">
                    <h4>Team Summary</h4>
                    <div class="summary-grid">
                        <div>Starting XI: <span id="summary-xi">0</span>/11</div>
                        <div>Bench: <span id="summary-bench">0</span>/4</div>
                        <div>Total Value: <span id="summary-value">0</span>m</div>
                        <div>Remaining: <span id="summary-remaining">100</span>m</div>
                    </div>
                </div>
                
                <div class="team-actions">
                    <button class="btn-clear" onclick="clearTeam()">Clear Team</button>
                    <button class="btn-auto" onclick="autoPick()">Auto Pick</button>
                    <button class="btn-submit" onclick="submitTeam()">Submit Team</button>
                </div>
            </div>

            <!-- Add this modal for position selection -->
            <div id="position-modal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <h3 id="modal-title">Select Player</h3>
                    <div id="modal-players"></div>
                </div>
            </div>
        </div>

        <div id="draft-mode" class="game-mode" style="display: none;">
            <h2>Draft Mode - Coming Soon!</h2>
            <p>Turn-based player selection with friends</p>
            <div class="draft-info">
                <p>Each team: 15 players (2 GK, 5 DEF, 5 MID, 3 FWD)</p>
                <p>Snake draft order</p>
            </div>
        </div>
        </main>

        <div id="loading" class="loading-overlay" style = "display: none;">
            <div class ="loading-spinner"></div>
            <p>Loading...</p>
        </div>
    </div>
    <script type = "module" src = "supabase.js"></script>
    <script type = "module" src = "auth.js"></script>
    <script src="script.js"></script>
</body>
</html>